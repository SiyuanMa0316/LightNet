{
    "ops": [
        {
            "optype": "sort1d_by_key",
            "author": "Zhao Zhixu",
            "arch": "none",
            "tensors_in": [
                {"arg_name": "key", "mtype": "LN_MEM_NONE", "ndim": 1},
                {"arg_name": "val", "mtype": "LN_MEM_NONE", "ndim": 1,
                 "len": "key->len", "dtype": "TL_INT32"},
            ],
            "tensors_out": [
                {"arg_name": "sorted_key", "mtype": "LN_MEM_NONE",
                 "owner": "key_name",
                 "ndim": "key->ndim", "dtype": "key->dtype",
                 "dims": "key->dims"},
                {"arg_name": "sorted_val", "mtype": "LN_MEM_NONE",
                 "owner": "val_name",
                 "ndim": "val->ndim", "dtype": "val->dtype",
                 "dims": "val->dims"}
            ],
            "params": [
                {"arg_name": "dir", "ptype": "LN_PARAM_STRING",
                 "from_func": "tl_sort_dir_from_str", "realtype": "int",
                 "check": "dir != -1, \"'dir' should be a supported tl_sort_dir\""}
            ]
        },
        {
            "optype": "sort1d_by_key_cpu",
            "author": "Zhao Zhixu",
            "arch": "cpu",
            "tensors_in": [
                {"arg_name": "key", "mtype": "LN_MEM_CPU", "ndim": 1},
                {"arg_name": "val", "mtype": "LN_MEM_CPU", "ndim": 1,
                 "len": "key->len", "dtype": "TL_INT32"},
            ],
            "tensors_out": [
                {"arg_name": "sorted_key", "mtype": "LN_MEM_CPU",
                 "owner": "key_name",
                 "ndim": "key->ndim", "dtype": "key->dtype",
                 "dims": "key->dims"},
                {"arg_name": "sorted_val", "mtype": "LN_MEM_CPU",
                 "owner": "val_name",
                 "ndim": "val->ndim", "dtype": "val->dtype", "dims": "val->dims"}
            ],
            "params": [
                {"arg_name": "dir", "ptype": "LN_PARAM_STRING",
                 "from_func": "tl_sort_dir_from_str", "realtype": "int",
                 "check": "dir != -1, \"'dir' should be a supported tl_sort_dir\""}
            ],
            "run": ""
        },
        {
            "optype": "sort1d_by_key_cuda",
            "author": "Zhao Zhixu",
            "arch": "cuda",
            "tensors_in": [
                {"arg_name": "key", "mtype": "LN_MEM_CUDA", "ndim": 1},
                {"arg_name": "val", "mtype": "LN_MEM_CUDA", "ndim": 1,
                 "len": "key->len", "dtype": "TL_INT32"},
            ],
            "tensors_out": [
                {"arg_name": "sorted_key", "mtype": "LN_MEM_CUDA",
                 "owner": "key_name",
                 "ndim": "key->ndim", "dtype": "key->dtype",
                 "dims": "key->dims"},
                {"arg_name": "sorted_val", "mtype": "LN_MEM_CUDA",
                 "owner": "val_name",
                 "ndim": "val->ndim", "dtype": "val->dtype", "dims": "val->dims"}
            ],
            "params": [
                {"arg_name": "dir", "ptype": "LN_PARAM_STRING",
                 "from_func": "tl_sort_dir_from_str", "realtype": "int",
                 "check": "dir != -1, \"'dir' should be a supported tl_sort_dir\""}
            ],
            "run": "tl_tensor_sort1d_by_key_cuda(key, val, dir);"
        },
    ]
}
