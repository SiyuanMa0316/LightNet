{
    "optype": "bn2scale_wts_cpu",
    "author": "Zhao Zhixu",
    "arch": "cpu",
    "tensors_in": [
        {"arg_name": "src_mean", "mtype": "LN_MEM_CPU",
         "dtype": "TL_FLOAT", "static": true, "ndim": 1},
        {"arg_name": "src_var", "mtype": "LN_MEM_CPU",
         "dtype": "TL_FLOAT", "static": true, "ndim": 1},
        {"arg_name": "src_scale", "mtype": "LN_MEM_CPU",
         "dtype": "TL_FLOAT", "static": true, "ndim": 1},
        {"arg_name": "src_offset", "mtype": "LN_MEM_CPU",
         "dtype": "TL_FLOAT", "static": true, "ndim": 1}
    ],
    "tensors_out": [
        {"arg_name": "dst_scale", "mtype": "LN_MEM_CPU", "static": true,
         "dtype": "src_mean->dtype", "ndim": "1", "dims": "src_mean->dims"},
        {"arg_name": "dst_shift", "mtype": "LN_MEM_CPU", "static": true,
         "dtype": "src_mean->dtype", "ndim": "1", "dims": "src_mean->dims"},
        {"arg_name": "dst_power", "mtype": "LN_MEM_CPU", "static": true,
         "dtype": "src_mean->dtype", "ndim": "1", "dims": "src_mean->dims"}
    ],
    "params": [
        {"arg_name": "epsilon", "ptype": "LN_PARAM_NUMBER", "realtype": "float",
         "gt": 0}
    ],
    "static_run": "float *dst_scale = priv->dst_scale->data;\nfloat *dst_shift = priv->dst_shift->data;\nfloat *dst_power = priv->dst_power->data;\nfloat *src_mean = priv->src_mean->data;\nfloat *src_var = priv->src_var->data;\nfloat *src_scale = priv->src_scale->data;\nfloat *src_offset = priv->src_offset->data;\nfor (int i = 0; i < priv->dst_scale->len; i++) {\n    dst_scale[i] = src_scale[i] / (src_var[i] + priv->epsilon);\n    dst_shift[i] = src_offset[i] - src_mean[i] * src_scale[i] / (src_var[i] + priv->epsilon);\n    dst_power[i] = 1;\n}"
}
